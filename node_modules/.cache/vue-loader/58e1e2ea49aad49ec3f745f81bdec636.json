{"remainingRequest":"C:\\GitTest\\vue-mooc\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\GitTest\\vue-mooc\\src\\pages\\cart\\cart.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\GitTest\\vue-mooc\\src\\pages\\cart\\cart.vue","mtime":1699492437946},{"path":"C:\\GitTest\\vue-mooc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1698895099045},{"path":"C:\\GitTest\\vue-mooc\\node_modules\\babel-loader\\lib\\index.js","mtime":1698895100317},{"path":"C:\\GitTest\\vue-mooc\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1698895099045},{"path":"C:\\GitTest\\vue-mooc\\node_modules\\vue-loader\\lib\\index.js","mtime":1698895084158}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport CartHeader from './cart-header.vue'\r\nimport Empty from 'components/empty/empty.vue'\r\nimport { getCartList, deleteCart } from 'api/cart.js'\r\nimport { ERR_OK } from 'api/config.js'\r\nimport { setCheckLessons } from 'utils/cache.js'\r\nexport default {\r\n  data () {\r\n    return {\r\n      cartList: []\r\n    }\r\n  },\r\n  mounted () {\r\n    this.getCartListData()\r\n  },\r\n  methods: {\r\n    // 全选事件\r\n    handleAllCheckClick () {\r\n      const isCheckAll = this.isCheckAll\r\n      this.cartList.forEach((item, index) => {\r\n        item.isCheck = !isCheckAll\r\n        this.$set(this.cartList, index, item)\r\n      })\r\n    },\r\n    // 勾选事件\r\n    handleCheckClick (course, index) {\r\n      course.isCheck = !course.isCheck\r\n      this.$set(this.cartList, index, course)\r\n    },\r\n    // 删除事件\r\n    handleDeleteClick (item) {\r\n      const params = {\r\n        id: item.id\r\n      }\r\n      deleteCart(params).then(res => {\r\n        const { code, msg } = res\r\n        if (code === ERR_OK) {\r\n          this.$message.success(msg)\r\n          this.getCartListData()\r\n        } else {\r\n          this.$message.error(msg)\r\n        }\r\n      }).catch(() => {\r\n        this.$message.error('接口异常')\r\n      })\r\n    },\r\n    // 去结算\r\n    handleAccountClick () {\r\n      if (this.isDisabled) {\r\n        return\r\n      }\r\n      const checkCartList = this.cartList.filter(item => item.isCheck)\r\n      if (checkCartList.length > 0) {\r\n        setCheckLessons(checkCartList)\r\n        this.$router.push('/cart/confirm')\r\n      } else {\r\n        this.$message.warning('请选择待结算的课程')\r\n      }\r\n    },\r\n    // 获取购物车列表接口数据\r\n    getCartListData () {\r\n      getCartList().then(res => {\r\n        let { code, data, msg } = res\r\n        if (code === ERR_OK) {\r\n          this.cartList = this.normalizeCartData(data)\r\n        } else {\r\n          this.cartList = []\r\n          this.$message.error(msg)\r\n        }\r\n      }).catch(() => {\r\n        this.cartList = []\r\n        this.$message.error('接口异常')\r\n      })\r\n    },\r\n    // 获取总计金额\r\n    getTotal () {\r\n      let list = this.cartList.slice()\r\n      let reuslt = 0\r\n      list.forEach(item => {\r\n        if (item.isCheck) {\r\n          reuslt  = reuslt + parseFloat(item.price)\r\n        }\r\n      })\r\n      return reuslt || 0\r\n    },\r\n    // 处理购物车数据\r\n    normalizeCartData (array) {\r\n      if (array.length === 0) {\r\n        return []\r\n      }\r\n      array = array.map(item => {\r\n        return Object.assign({\r\n          isCheck: true\r\n        }, item)\r\n      })\r\n      return array\r\n    }\r\n  },\r\n  computed: {\r\n    isCheckAll () {\r\n      return this.cartList.every(item => item.isCheck)\r\n    },\r\n    checkNumber () {\r\n      return this.cartList.filter(item => item.isCheck).length\r\n    }\r\n  },\r\n  components: {\r\n    CartHeader,\r\n    Empty\r\n  }\r\n}\r\n",{"version":3,"sources":["cart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"cart.vue","sourceRoot":"src/pages/cart","sourcesContent":["<template>\r\n  <div class=\"cart\">\r\n    <!-- 头部 -->\r\n    <cart-header>\r\n      <span class=\"cart-name\">我的课程</span>\r\n      <span class=\"number\">共{{ cartList.length }}门，已选{{ checkNumber }}门</span>\r\n      <router-link class=\"history-order\" to=\"/order\">我的订单历史</router-link>\r\n    </cart-header>\r\n\r\n    <!-- 购物车列表 -->\r\n    <div class=\"cart-list m-center\">\r\n      <template v-if=\"cartList.length\">\r\n        <dl>\r\n          <dt class=\"cart-list-header\">\r\n            <span class=\"checkbox-all\" @click=\"handleAllCheckClick\">\r\n              <i v-if=\"isCheckAll\" class=\"iconfont\">&#xe617;</i>\r\n              <i v-else class=\"iconfont no-check\">&#xe630;</i>\r\n              全选\r\n            </span>\r\n            <span class=\"course-name\">课程</span>\r\n            <span class=\"price\">金额</span>\r\n            <span>操作</span>\r\n          </dt>\r\n          <dd v-for=\"(course,index) in cartList\" :key=\"index\" class=\"cart-item\">\r\n            <div class=\"checkbox\">\r\n              <span @click=\"handleCheckClick(course,index)\">\r\n                <i v-if=\"course.isCheck\" class=\"iconfont\">&#xe617;</i>\r\n                <i v-else class=\"iconfont no-check\">&#xe630;</i>\r\n              </span>\r\n            </div>\r\n            <div class=\"course-box\">\r\n              <div class=\"img-box\">\r\n                <img :src=\"course.img\" alt=\"\">\r\n              </div>\r\n              <div class=\"course-content\">\r\n                <p class=\"name\">\r\n                  {{ course.title }}\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <div class=\"price\">\r\n              ¥ {{ course.isDiscount ? course.discountPrice : course.price }}\r\n            </div>\r\n            <div class=\"close\" @click=\"handleDeleteClick(course)\">\r\n              <i class=\"iconfont\">&#xe619;</i>\r\n            </div>\r\n          </dd>\r\n        </dl>\r\n        <div class=\"account-box\">\r\n          <div class=\"right\">\r\n            <div class=\"price-box\">\r\n              <p class=\"title\">\r\n                总计金额：\r\n              </p>\r\n              <p class=\"price\">\r\n                ¥ {{ getTotal() }}\r\n              </p>\r\n            </div>\r\n            <button\r\n              class=\"account-btn\"\r\n              :class=\"{'is-disabled': checkNumber == 0}\"\r\n              @click=\"handleAccountClick\"\r\n            >\r\n              去结算\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </template>\r\n      <empty v-else message=\"购物车内空空如也\"></empty>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport CartHeader from './cart-header.vue'\r\nimport Empty from 'components/empty/empty.vue'\r\nimport { getCartList, deleteCart } from 'api/cart.js'\r\nimport { ERR_OK } from 'api/config.js'\r\nimport { setCheckLessons } from 'utils/cache.js'\r\nexport default {\r\n  data () {\r\n    return {\r\n      cartList: []\r\n    }\r\n  },\r\n  mounted () {\r\n    this.getCartListData()\r\n  },\r\n  methods: {\r\n    // 全选事件\r\n    handleAllCheckClick () {\r\n      const isCheckAll = this.isCheckAll\r\n      this.cartList.forEach((item, index) => {\r\n        item.isCheck = !isCheckAll\r\n        this.$set(this.cartList, index, item)\r\n      })\r\n    },\r\n    // 勾选事件\r\n    handleCheckClick (course, index) {\r\n      course.isCheck = !course.isCheck\r\n      this.$set(this.cartList, index, course)\r\n    },\r\n    // 删除事件\r\n    handleDeleteClick (item) {\r\n      const params = {\r\n        id: item.id\r\n      }\r\n      deleteCart(params).then(res => {\r\n        const { code, msg } = res\r\n        if (code === ERR_OK) {\r\n          this.$message.success(msg)\r\n          this.getCartListData()\r\n        } else {\r\n          this.$message.error(msg)\r\n        }\r\n      }).catch(() => {\r\n        this.$message.error('接口异常')\r\n      })\r\n    },\r\n    // 去结算\r\n    handleAccountClick () {\r\n      if (this.isDisabled) {\r\n        return\r\n      }\r\n      const checkCartList = this.cartList.filter(item => item.isCheck)\r\n      if (checkCartList.length > 0) {\r\n        setCheckLessons(checkCartList)\r\n        this.$router.push('/cart/confirm')\r\n      } else {\r\n        this.$message.warning('请选择待结算的课程')\r\n      }\r\n    },\r\n    // 获取购物车列表接口数据\r\n    getCartListData () {\r\n      getCartList().then(res => {\r\n        let { code, data, msg } = res\r\n        if (code === ERR_OK) {\r\n          this.cartList = this.normalizeCartData(data)\r\n        } else {\r\n          this.cartList = []\r\n          this.$message.error(msg)\r\n        }\r\n      }).catch(() => {\r\n        this.cartList = []\r\n        this.$message.error('接口异常')\r\n      })\r\n    },\r\n    // 获取总计金额\r\n    getTotal () {\r\n      let list = this.cartList.slice()\r\n      let reuslt = 0\r\n      list.forEach(item => {\r\n        if (item.isCheck) {\r\n          reuslt  = reuslt + parseFloat(item.price)\r\n        }\r\n      })\r\n      return reuslt || 0\r\n    },\r\n    // 处理购物车数据\r\n    normalizeCartData (array) {\r\n      if (array.length === 0) {\r\n        return []\r\n      }\r\n      array = array.map(item => {\r\n        return Object.assign({\r\n          isCheck: true\r\n        }, item)\r\n      })\r\n      return array\r\n    }\r\n  },\r\n  computed: {\r\n    isCheckAll () {\r\n      return this.cartList.every(item => item.isCheck)\r\n    },\r\n    checkNumber () {\r\n      return this.cartList.filter(item => item.isCheck).length\r\n    }\r\n  },\r\n  components: {\r\n    CartHeader,\r\n    Empty\r\n  }\r\n}\r\n</script>\r\n<style lang=\"stylus\" scoped>\r\n  .cart\r\n    margin-bottom: 60px;\r\n    .cart-name\r\n      margin-right: 25px;\r\n      font-size: 32px;\r\n      color: #07111b;\r\n    .history-order\r\n      float: right;\r\n      padding-top: 5px;\r\n      cursor: pointer;\r\n      &:hover\r\n        color: #f01414;\r\n    .cart-list\r\n      margin-top: -40px;\r\n      padding: 0 36px 32px;\r\n      background-color: #fff;\r\n      box-shadow: 0 8px 16px rgba(7,17,27,0.1);\r\n      border-radius: 8px;\r\n      box-sizing: border-box;\r\n      dl\r\n        .cart-list-header\r\n          display: flex;\r\n          align-items: center;\r\n          min-height: 88px;\r\n          line-height: 88px;\r\n          border-bottom: 1px solid #b7bbbf;\r\n          & > span\r\n            flex: 0 0 88px;\r\n            width: 88px;\r\n            font-size: 14px;\r\n            &:not(:first-child)\r\n              padding-left: 48px;\r\n            &.checkbox-all\r\n              color: #93999f;\r\n              .iconfont\r\n                display: inline-block;\r\n                vertical-align: middle;\r\n                margin-right: 8px;\r\n                color: #37f;\r\n                font-size: 22px;\r\n                cursor: pointer;\r\n                &.no-check\r\n                  color: #b7bbbf;\r\n            &.course-name\r\n              flex: 1;\r\n            &.price\r\n              flex: 0 0 188px;\r\n              width: 188px;\r\n        .cart-item\r\n          display: flex;\r\n          align-items: center;\r\n          padding: 24px 0;\r\n          border-bottom: 1px solid #d9dde1;\r\n          & > div\r\n            flex: 0 0 88px;\r\n            width: 88px;\r\n            &:not(:first-child)\r\n              margin-left: 48px;\r\n            &.checkbox\r\n              & > span\r\n                display: inline-block;\r\n                .iconfont\r\n                  font-size: 22px;\r\n                  color: #37f;\r\n                  cursor: pointer;\r\n                  &.no-check\r\n                    color: #b7bbbf;\r\n            &.course-box\r\n              flex: 1;\r\n              display: flex;\r\n              align-items: flex-start;\r\n              .img-box\r\n                width: 160px;\r\n                height: 90px;\r\n                & > img\r\n                  display: block;\r\n                  width: 100%;\r\n                  height: 100%;\r\n                  background-color: #eee;\r\n              .course-content\r\n                flex: 1;\r\n                margin-left: 24px;\r\n                .name\r\n                  margin: 4px 0 8px;\r\n                  line-height: 24px;\r\n                  font-size: 16px;\r\n                  color: #07111b;\r\n                .package\r\n                  padding: 4px 8px;\r\n                  border-radius: 12px;\r\n                  background-color: rgba(240,20,20,.08);\r\n                  font-size: 12px;\r\n                  color: rgba(240,20,20,.6);\r\n                  cursor: pointer;\r\n                  &:hover\r\n                    background-color: #f01414;\r\n                    color: #fff;\r\n            &.price\r\n              flex: 0 0 188px;\r\n              width: 188px;\r\n              color: #1c1f21;\r\n              font-weight: 700;\r\n            &.close\r\n              .iconfont\r\n                font-size: 24px;\r\n                color: #b7bbbf;\r\n                cursor: pointer;\r\n                &:hover\r\n                  color: #f01414;\r\n      .account-box\r\n        overflow: hidden;\r\n        .right\r\n          float: right;\r\n          height: 78px;\r\n          & > div\r\n            margin-top: 24px;\r\n            display: inline-block;\r\n            vertical-align: middle;\r\n          .price-box\r\n            margin-right: 40px;\r\n            width: 150px;\r\n            & > p\r\n              font-size: 12px;\r\n              color: #07111b;\r\n              line-height: 24px;\r\n              &.price\r\n                font-size: 18px;\r\n                color: #f01414;\r\n                font-weight: 700;\r\n                letter-spacing: 1px;\r\n          .account-btn\r\n            padding: 13px 32px;\r\n            border-radius: 6px;\r\n            background-color: #f01414;\r\n            border: none;\r\n            outline: none;\r\n            line-height: 24px;\r\n            color: #fff;\r\n            font-size: 16px;\r\n            cursor: pointer;\r\n            &.is-disabled\r\n              background-color: rgba(240, 20, 20, 0.5);\r\n              cursor: not-allowed;\r\n              pointer-events: none;\r\n</style>"]}]}